<!doctype html>
<html lang="si">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Standerd_Calculater</title>
  <style>
    :root{
      --bg:#0f1724; --panel:#111827; --accent:#06b6d4; --btn:#1f2937; --text:#e6eef6;
      --danger:#ef4444;
    }
    *{box-sizing:border-box;font-family:Inter,system-ui,"Segoe UI",Roboto,"Noto Sans Sinhala",sans-serif}
    body{
      margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center;
      background:radial-gradient(circle at top,#0b1220 10%, #071020 90%);
      color:var(--text); padding:20px;
    }
    .calc {
      width:360px; max-width:96vw;
      background:linear-gradient(180deg,var(--panel), #0b1220);
      border-radius:16px; padding:18px;
      box-shadow:0 10px 30px rgba(0,0,0,.6);
      backdrop-filter:blur(6px);
    }
    .display {
      background:rgba(255,255,255,0.05); padding:12px; border-radius:10px;
      min-height:70px; display:flex; flex-direction:column; justify-content:center;
      margin-bottom:14px; box-shadow:inset 0 0 8px rgba(0,0,0,.3);
    }
    .expr { font-size:14px; color:#9fb6c6; word-break:break-all; }
    .result { font-size:30px; font-weight:600; margin-top:6px; text-align:right; transition:all .2s ease; }
    .keys { display:grid; grid-template-columns:repeat(4,1fr); gap:8px; }
    button {
      background:var(--btn); color:var(--text); border:0; padding:14px;
      border-radius:10px; font-size:18px; cursor:pointer; user-select:none;
      box-shadow:inset 0 -2px 0 rgba(0,0,0,.3), 0 2px 4px rgba(0,0,0,.4);
      transition:all .1s ease;
    }
    button:hover{background:var(--accent);color:#fff;transform:translateY(-2px);}
    button:active{transform:scale(0.95);}
    button.op { background:transparent; border:1px solid rgba(255,255,255,0.08); color:var(--accent); }
    button.wide { grid-column:span 2; }
    button.danger { background:var(--danger); color:white; }
    .history {
      margin-top:12px; max-height:120px; overflow:auto; font-size:13px; color:#b8d6de;
      border-top:1px dashed rgba(255,255,255,0.05); padding-top:8px;
    }
    .history-item { padding:6px 4px; display:flex; justify-content:space-between; gap:10px; }
    .hint { font-size:12px; color:#8aa5b3; margin-top:8px; text-align:center; }
    #copyBtn{
      width:100%;background:transparent;border:1px solid var(--accent);color:var(--accent);
      margin-top:10px;padding:8px;border-radius:8px;cursor:pointer;transition:.2s;
    }
    #copyBtn:hover{background:var(--accent);color:#fff;}
    @media (max-width:420px){
      .result{ font-size:22px }
      button{ padding:12px; font-size:16px }
    }
    .flash {
      animation: flash 0.2s ease;
    }
    @keyframes flash{
      from{background-color:var(--accent);color:white;}
      to{background-color:var(--btn);}
    }
  </style>
</head>
<body>
  <main class="calc" role="application" aria-label="Calculator">
    <div class="display" id="display">
      <div class="expr" id="expression">0</div>
      <div class="result" id="result">0</div>
    </div>

    <div class="keys" id="keys">
      <button class="op danger" data-action="clear">C</button>
      <button class="op" data-action="back">⌫</button>
      <button class="op" data-value="%">%</button>
      <button class="op" data-value="/">÷</button>

      <button data-value="7">7</button>
      <button data-value="8">8</button>
      <button data-value="9">9</button>
      <button class="op" data-value="*">×</button>

      <button data-value="4">4</button>
      <button data-value="5">5</button>
      <button data-value="6">6</button>
      <button class="op" data-value="-">−</button>

      <button data-value="1">1</button>
      <button data-value="2">2</button>
      <button data-value="3">3</button>
      <button class="op" data-value="+">+</button>

      <button data-value="0">0</button>
      <button data-value=".">.</button>
      <button data-value="√(">√</button>
      <button class="op wide" data-action="equals">=</button>
    </div>

    <button id="copyBtn">Copy Result</button>

    <div class="hint">Keyboard supported: 0–9, + - * / ( ) . Enter, Backspace, Esc</div>
    <div class="history" id="history" aria-live="polite"></div>
  </main>

  <script>
    (function(){
      const exprEl=document.getElementById('expression');
      const resEl=document.getElementById('result');
      const keys=document.getElementById('keys');
      const historyEl=document.getElementById('history');
      const copyBtn=document.getElementById('copyBtn');
      let expression='';

      const clickSound=new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_d7b2ec86d7.mp3");
      clickSound.volume=0.15;

      function render(){exprEl.textContent=expression||'0';}
      function sanitizeForEval(s){if(!/^[0-9+\-*/().%\s√]+$/.test(s))return null;return s;}
      function evaluateExpression(expr){
        const safe=sanitizeForEval(expr);
        if(!safe)throw new Error("Invalid");
        const prepared=safe.replace(/√\(/g,"Math.sqrt(").replace(/%/g,"/100");
        return Function('"use strict";return ('+prepared+')')();
      }

      function pushHistory(expr,result){
        const item=document.createElement('div');
        item.className='history-item';
        item.innerHTML=`<span>${expr}</span><strong>${result}</strong>`;
        historyEl.prepend(item);
        while(historyEl.children.length>15)historyEl.removeChild(historyEl.lastChild);
      }

      function formatResult(r){
        if(typeof r==='number'){
          if(!isFinite(r))return r.toString();
          return Number.parseFloat(r.toPrecision(12)).toString();
        }
        return String(r);
      }

      keys.addEventListener('click',e=>{
        const btn=e.target.closest('button'); if(!btn)return;
        clickSound.currentTime=0; clickSound.play();
        btn.classList.add("flash"); setTimeout(()=>btn.classList.remove("flash"),150);
        const val=btn.dataset.value; const action=btn.dataset.action;
        if(action==="clear"){expression='';resEl.textContent='0';render();return;}
        if(action==="back"){expression=expression.slice(0,-1);render();return;}
        if(action==="equals"){
          try{
            const res=evaluateExpression(expression||'0');
            const formatted=formatResult(res);
            resEl.textContent=formatted;
            pushHistory(expression,formatted);
            expression=formatted; render();
          }catch{
            resEl.textContent="Error";
            setTimeout(()=>{resEl.textContent='0';expression='';render();},1200);
          }
          return;
        }
        if(val){expression+=val;render();}
      });

      window.addEventListener('keydown',e=>{
        const allowed='0123456789+-*/().%';
        if(e.key==='Enter'){e.preventDefault();document.querySelector('[data-action="equals"]').click();return;}
        if(e.key==='Escape'){expression='';resEl.textContent='0';render();return;}
        if(e.key==='Backspace'){expression=expression.slice(0,-1);render();return;}
        if(allowed.includes(e.key)){expression+=e.key;render();}
      });

      copyBtn.addEventListener('click',()=>{
        navigator.clipboard.writeText(resEl.textContent);
        copyBtn.textContent='✅ Copied!';
        setTimeout(()=>copyBtn.textContent='Copy Result',1500);
      });

      render();
    })();
  </script>
</body>
</html>

